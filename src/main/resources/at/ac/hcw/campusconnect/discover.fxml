<?xml version="1.0" encoding="UTF-8"?>

<?import at.ac.hcw.campusconnect.components.ErrorBox?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.SVGPath?>
<StackPane xmlns:fx="http://javafx.com/fxml"
           xmlns="http://javafx.com/javafx"
           fx:controller="at.ac.hcw.campusconnect.controller.DiscoverController"
           styleClass="discover-container">

    <!-- Error Box -->
    <ErrorBox fx:id="errorBox" StackPane.alignment="TOP_CENTER">
        <StackPane.margin>
            <Insets top="20"/>
        </StackPane.margin>
    </ErrorBox>

    <!-- Main Content -->
    <VBox alignment="CENTER" spacing="30" styleClass="discover-content">
        <padding>
            <Insets top="40" bottom="40" left="40" right="40"/>
        </padding>

        <!-- Header -->
        <HBox alignment="CENTER" spacing="15">
            <Label text="Discover" styleClass="page-title"/>
        </HBox>

        <!-- Card Container -->
        <StackPane fx:id="cardContainer" styleClass="card-container" prefHeight="550" prefWidth="400">
            <!-- Empty State -->
            <VBox fx:id="emptyState" alignment="CENTER" spacing="20" styleClass="empty-state" visible="false">
                <SVGPath
                        content="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"
                        styleClass="empty-icon" scaleX="3" scaleY="3"/>
                <Label text="No more profiles to discover!" styleClass="empty-title"/>
                <Label text="Check back later for new matches" styleClass="empty-subtitle"/>
            </VBox>

            <!-- Profile Card -->
            <VBox fx:id="profileCard" styleClass="profile-card" spacing="0" visible="false">
                <!-- Image Section -->
                <StackPane fx:id="imageSection" styleClass="profile-image-section" VBox.vgrow="ALWAYS">
                    <!-- Gradient Overlay -->
                    <VBox StackPane.alignment="BOTTOM_LEFT" styleClass="profile-overlay">
                        <padding>
                            <Insets top="80" bottom="20" left="20" right="20"/>
                        </padding>
                        <Label fx:id="profileName" text="Name, 22" styleClass="profile-name"/>
                        <Label fx:id="profileInfo" text="Study Program â€¢ Semester" styleClass="profile-info"/>
                    </VBox>

                    <ImageView fx:id="profileImage" preserveRatio="true" fitWidth="400" fitHeight="350"/>

                    <!-- Image Navigation Indicators -->
                    <HBox fx:id="imageIndicators" alignment="CENTER" spacing="8" StackPane.alignment="BOTTOM_CENTER">
                        <StackPane.margin>
                            <Insets bottom="-320"/>
                        </StackPane.margin>
                    </HBox>
                </StackPane>

                <!-- Info Section -->
                <VBox styleClass="profile-info-section" spacing="15">
                    <padding>
                        <Insets top="20" bottom="20" left="20" right="20"/>
                    </padding>

                    <!-- Bio -->
                    <VBox spacing="8">
                        <Label text="About" styleClass="info-section-title"/>
                        <Label fx:id="profileBio" wrapText="true" styleClass="profile-bio"/>
                    </VBox>

                    <!-- Interests -->
                    <VBox spacing="8">
                        <Label text="Interests" styleClass="info-section-title"/>
                        <FlowPane fx:id="interestsPane" hgap="8" vgap="8"/>
                    </VBox>

                    <!-- Looking For -->
                    <HBox spacing="20">
                        <VBox spacing="5">
                            <Label text="Looking For" styleClass="info-label"/>
                            <Label fx:id="lookingForLabel" styleClass="info-value"/>
                        </VBox>
                        <VBox spacing="5">
                            <Label text="Interested In" styleClass="info-label"/>
                            <Label fx:id="interestedInLabel" styleClass="info-value"/>
                        </VBox>
                    </HBox>
                </VBox>
            </VBox>
        </StackPane>

        <!-- Action Buttons -->
        <HBox alignment="CENTER" spacing="30" fx:id="actionButtons" visible="false">
            <Button fx:id="passButton" styleClass="action-button, pass-button" onAction="#handlePass">
                <graphic>
                    <SVGPath
                            content="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"
                            styleClass="action-icon" scaleX="1.5" scaleY="1.5"/>
                </graphic>
            </Button>

            <Button fx:id="likeButton" styleClass="action-button, like-button" onAction="#handleLike">
                <graphic>
                    <SVGPath
                            content="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                            styleClass="action-icon" scaleX="1.5" scaleY="1.5"/>
                </graphic>
            </Button>
        </HBox>

        <!-- Loading Indicator -->
        <ProgressIndicator fx:id="loadingIndicator" visible="false"/>
    </VBox>
</StackPane>
